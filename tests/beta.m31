Parameter Pair : Type -> Type -> Type.

Parameter pair :
  forall (A : Type) (B : Type),
    A -> (B -> (Pair A B)).

(* This will have to be reduced. What whould be an example where
   the whnf isn't equal to Type -> Type so that the full normal
   form would be required? *)
(* Let foo := *)
(*   pair *)
(*     Type *)
(*     ((fun (_ : Type) => (Type -> Type)) Type) *)
(*     Type *)
(*     (fun (_ : Type) => Type) *)
(*     :: Pair Type (Type -> Type). *)

Parameter fst :
  forall (X : Type) (Y : Type), Pair X Y -> X.

Let beta_fst :=
  forall (U V : Type) (u : U) (v : V),
    fst U V (pair U V u v) == u.

(* Let boa := *)
(*   beta beta_fst in *)
(*     (fun (A B : Type) (a : A) (b : B) => *)
(*        (refl (fst A B (pair A B a b))) *)
(*          :: *)
(*          (fst A B (pair A B a b)) == (fst A B (pair A B a b))). *)

(* fails for now *)
(* compute the ascription: first compute the refl which yields that the refl *)
(* has type t' = fst … == fst … , then check if it matches the ascribed type, *)
(* which triggers Eq A (fst …) (fst …) =?= Eq A (fst …) a which should at some *)
(* point ask (fst …) =?= a, which in turn tries to whnf (fst …), entering *)
(* [whnf_spine] and [try_beta] with debugging time around 27790 *)
Let boa :=
  beta beta_fst in
    (fun (C D : Type) (c : C) (d : D) =>
       (refl (fst C D (pair C D ((fun (t : Type) (x : t) => x) C c) d)))
         ::
         c == (fst C D (pair C D c d))
).

Check boa.


(* (buffer-local-set-key (kbd "C-M-x") 'm31-send-current-statement) *)
